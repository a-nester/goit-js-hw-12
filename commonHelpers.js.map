{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '43256839-6988dc73e83ff3bdf7562f6e8';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function createFetch(searchValue, page) {\n  const data = axios(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: searchValue,\n      image_type: 'photo',\n      orientation: 'horizontal',\n          safesearch: true,\n          per_page: 15,\n          page: page\n    }});\n  return data;\n}\n\n","export function createMarkup(arr) {\n  return arr\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n      return `\n        <li class=\"gallery-item\" >\n        <a class=\"gallery-link\" href=${largeImageURL}>\n          <img class=\"gallery-image\"\n          src=\"${webformatURL}\" \n          data-source=\"${largeImageURL}\" \n          alt=\"${tags}\" />\n          \n        </a>\n        <div class=\"data-box\">\n            <div>\n                <p class=\"item-box-bolt\">Likes</p>\n                <p class=\"item-box\">${likes}</p>\n            </div>\n            <div>\n                <p class=\"item-box-bolt\">Views</p>\n                <p class=\"item-box\">${views}</p>\n            </div>\n            <div>\n                <p class=\"item-box-bolt\">Comments</p>\n                <p class=\"item-box\">${comments}</p>\n            </div>\n            <div>\n                <p class=\"item-box-bolt\">Downloads</p>\n                <p class=\"item-box\">${downloads}</p>\n            </div>\n        </div>\n      </li>\n    `;\n    })\n    .join('');\n}\n","import axios from \"axios\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { createFetch } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\nconst searchForm = document.querySelector(\".search-form\");\nconst galleryList = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadBtn = document.querySelector(\".js-load-more\");\n\nsearchForm.addEventListener(\"submit\", handleClick);\nloadBtn.addEventListener(\"click\", handleLoadMore);\nlet page = null;\nlet searchValue = \"\";\n\nasync function handleClick(event) {\n    event.preventDefault();\n    loaderToggle();\n    page = 1;\n    searchValue = searchForm.elements[0].value.trim();\n    if (!searchValue) {\n        loaderToggle();\n        return iziToast.error({\n            position: \"topRight\",\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n    }\n    try {\n        const { data } = await createFetch(searchValue, page);\n            \n                if (data.hits.length === 0) {\n                    return iziToast.error({\n                        position: \"topRight\",\n                        message: \"Sorry, there are no images matching your search query. Please try again!\",\n                    });\n                }\n                let gallery = new SimpleLightbox('.gallery a', {\n                    captionsData: \"alt\",\n                    captionDelay: 250,\n                    captionClass: 'text-center'\n                });\n            \n                galleryList.innerHTML = createMarkup(data.hits);\n                gallery.refresh();\n                const totalPages = Math.ceil(data.totalHits / data.hits.length)\n                if (page < totalPages) {\n                    loadBtn.classList.replace(\"load-more-hiden\", \"load-more\")\n                }\n    } catch {\n        iziToast.error({\n            position: \"topRight\",\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        })\n    } finally {\n            searchForm.elements[0].value = \"\";\n            loaderToggle();\n    }\n}\n\nasync function handleLoadMore() {\n    loadBtn.classList.replace(\"load-more\", \"load-more-hiden\")\n    loaderToggle();\n    page += 1;\n    try {\n        const { data } = await createFetch(searchValue, page)\n        \n        // if (data.hits.length === 0) {\n        //     return iziToast.error({\n        //         position: \"topRight\",\n        //         message: \"Sorry, there are no images matching your search query. Please try again!\",\n        //     });\n        // }\n        let gallery = new SimpleLightbox('.gallery a', {\n            captionsData: \"alt\",\n            captionDelay: 250,\n            captionClass: 'text-center'\n        });\n        const totalPages = Math.ceil(data.totalHits / data.hits.length)    \n        galleryList.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits));\n        gallery.refresh();\n        \n        if (page < totalPages) {\n            loadBtn.classList.replace(\"load-more-hiden\", \"load-more\")\n        } else {\n            loadBtn.classList.replace(\"load-more\", \"load-more-hiden\")\n            return iziToast.error({\n                position: \"topRight\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        }\n    } catch {\n        iziToast.error({\n            position: \"topRight\",\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        })\n    } finally {\n            loaderToggle();\n            const domRect = galleryList.firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: domRect.height * 2,\n            behavior: \"smooth\"\n        });\n    }\n}\n\nfunction loaderToggle() {\n    loader.classList.toggle('isHiden');\n}\n\n\n"],"names":["API_KEY","BASE_URL","createFetch","searchValue","page","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","galleryList","loader","loadBtn","handleClick","handleLoadMore","event","loaderToggle","iziToast","data","gallery","SimpleLightbox","totalPages","domRect"],"mappings":"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"}