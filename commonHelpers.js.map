{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '43256839-6988dc73e83ff3bdf7562f6e8';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function createFetch(searchValue, page) {\n  try {\n    const data = axios(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: searchValue,\n        image_type: 'photo',\n        orientation: 'horizontal',\n            safesearch: true,\n            per_page: 15,\n            page: page\n      }});\n    return data;\n  } catch (error) {\n    return error;\n    \n  }\n}\n\n","export function createMarkup(arr) {\n  return arr\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n      return `\n        <li class=\"gallery-item\" >\n        <a class=\"gallery-link\" href=${largeImageURL}>\n          <img class=\"gallery-image\"\n          src=\"${webformatURL}\" \n          data-source=\"${largeImageURL}\" \n          alt=\"${tags}\" />\n          \n        </a>\n        <div class=\"data-box\">\n            <div>\n                <p class=\"item-box-bolt\">Likes</p>\n                <p class=\"item-box\">${likes}</p>\n            </div>\n            <div>\n                <p class=\"item-box-bolt\">Views</p>\n                <p class=\"item-box\">${views}</p>\n            </div>\n            <div>\n                <p class=\"item-box-bolt\">Comments</p>\n                <p class=\"item-box\">${comments}</p>\n            </div>\n            <div>\n                <p class=\"item-box-bolt\">Downloads</p>\n                <p class=\"item-box\">${downloads}</p>\n            </div>\n        </div>\n      </li>\n    `;\n    })\n    .join('');\n}\n","import axios from \"axios\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { createFetch } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\nconst searchForm = document.querySelector(\".search-form\");\nconst galleryList = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadBtn = document.querySelector(\".js-load-more\");\n\nsearchForm.addEventListener(\"submit\", handleClick);\nloadBtn.addEventListener(\"click\", handleLoadMore);\nlet totalPages = 0;\nlet page = 1;\nlet searchValue = \"\";\n\nlet gallery = new SimpleLightbox('.gallery a', {\n            captionsData: \"alt\",\n            captionDelay: 250,\n            captionClass: 'text-center'\n        });\n\nasync function handleClick(event) {\n    event.preventDefault();\n    page = 1;\n    galleryList.innerHTML = '';\n    loader.classList.remove('isHiden');\n    loadBtn.classList.replace(\"load-more\", \"load-more-hiden\");\n    searchValue = searchForm.elements[0].value.trim();\n\n    if (!searchValue) {\n        loader.classList.add('isHiden');\n        return iziToast.error({\n            position: \"topRight\",\n            message: \"Input is empty. Fill input please!\"\n        });\n    }\n    try {\n        const { data } = await createFetch(searchValue, page);\n            \n        if (data.hits.length === 0) {\n                    return iziToast.error({\n                        position: \"topRight\",\n                        message: \"Sorry, there are no images matching your search query. Please try again!\",\n                    });\n                }\n                \n        galleryList.innerHTML = createMarkup(data.hits);\n        if (data.totalHits > data.hits.length) {\n            loadBtn.classList.replace(\"load-more-hiden\", \"load-more\");\n        } \n        gallery.refresh();\n        totalPages = Math.ceil(data.totalHits / data.hits.length);\n    } catch {\n        loadBtn.classList.replace(\"load-more\", \"load-more-hiden\")\n        iziToast.error({\n            position: \"topRight\",\n            message: \"Something went wrong. Please try again!\"\n        })\n    } finally {\n            searchForm.elements[0].value = \"\";\n            loader.classList.add('isHiden');\n    }\n}\n\nasync function handleLoadMore() {\n    loadBtn.classList.replace(\"load-more\", \"load-more-hiden\");\n    loader.classList.remove('isHiden');\n    page += 1;\n    try {\n        const { data } = await createFetch(searchValue, page);\n        \n        galleryList.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits));\n        gallery.refresh();\n        \n        if (page < totalPages) {\n            loadBtn.classList.replace(\"load-more-hiden\", \"load-more\");\n        } else {\n            iziToast.error({\n            position: \"topRight\",\n            message: \"We're sorry, but you've reached the end of search results.\",\n        })\n        }\n    } catch {\n        iziToast.error({\n            position: \"topRight\",\n            message: \"Something went wrong. Please try again!\"\n        })\n    } finally {\n        loader.classList.add('isHiden');\n        const domRect = galleryList.firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: domRect.height * 2,\n            behavior: \"smooth\"\n        });\n    }\n}\n\n\n"],"names":["API_KEY","BASE_URL","createFetch","searchValue","page","axios","error","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","galleryList","loader","loadBtn","handleClick","handleLoadMore","totalPages","gallery","SimpleLightbox","event","iziToast","data","domRect"],"mappings":"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"}